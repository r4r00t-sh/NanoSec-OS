# NanoSec Firewall Rules Configuration
# =====================================
# This file defines custom firewall rules
# Format: <action> <direction> <protocol> <port> [source]
#
# Actions: allow, deny, limit
# Directions: in, out
# Protocols: tcp, udp, icmp, any
#

# ============================================
# ALLOWED INCOMING PORTS
# ============================================

# SSH (rate limited in script)
allow in tcp 22

# HTTP/HTTPS
allow in tcp 80
allow in tcp 443

# DNS (if running DNS server)
# allow in udp 53
# allow in tcp 53

# ============================================
# ALLOWED OUTGOING PORTS
# ============================================

# DNS resolution
allow out udp 53
allow out tcp 53

# HTTP/HTTPS
allow out tcp 80
allow out tcp 443

# NTP
allow out udp 123

# ============================================
# BLOCKED PORTS
# ============================================

# Block common attack vectors
deny in tcp 23      # Telnet
deny in tcp 135     # RPC
deny in tcp 137     # NetBIOS
deny in tcp 138     # NetBIOS
deny in tcp 139     # NetBIOS
deny in tcp 445     # SMB
deny in tcp 3389    # RDP

# ============================================
# RATE LIMITS
# ============================================

# SSH brute force protection
limit in tcp 22 3/minute

# ICMP flood protection
limit in icmp any 1/second

# ============================================
# GEO BLOCKING (optional)
# ============================================

# Block specific countries (requires xtables-addons)
# geoblock CN RU KP

# ============================================
# IP WHITELIST
# ============================================

# Trusted IPs (bypass rate limiting)
# whitelist 10.0.0.0/8
# whitelist 192.168.0.0/16

# ============================================
# IP BLACKLIST
# ============================================

# Known malicious IPs
# blacklist 1.2.3.4
